# Raspberry Pi Data Acquisition and Control System (PiDACS)

# Remove all PiDACS components and stop the PiDACS server daemon, if running.

# The install script is normally executed from <usr>/src.  Usage examples are
# as follows:

# <usr>/src/remove                  # Remove PiDACS files and directories from
#                                     HOME.
# export USR_DIR=/usr/local         # Remove PiDACS files and directories from
# <usr>/src/remove                    /usr/local.

# remove is also designed to be used with papamac's personal package usility
# (p2pkg).  Usage examples are as follows:

# p2pkg -r PiDACS                   # Remove PiDACS files and directories from
#                                     HOME.
# sudo p2pkg -ru /usr/local PiDACS  # Remove PiDACS files and directories from
#                                     /usr/local.

# Set directory variables.

if [ $XTRACE ]; then
    set -x
fi
usr=${USR_DIR:-~}                   # <usr> directory.
if [ $usr == /root ]; then
    echo 'install: usr directory is /root; use sudo -E to preserve the user environment'
    exit 1
fi
bin=$usr/bin                        # <bin> directory.
src=$usr/src                        # <src> directory.
var=/var/local                      # <var> directory.
log=$var/log                        # <log> directory.

# Remove PiDACS files.

echo "remove: Removing PiDACS files and directories from $usr"
rm -f $bin/iomgr $bin/pic $bin/pidacs
rm -fr $src/pidacs
rm -fr $log/iomgr
rm -fr $log/pidacs

# Stop PiDACS daemon and remove the daemon script/link.

sudo killall -q pidacs
sudo rm -f /etc/init.d/pidacsd
sudo update-rc.d pidacsd remove
